"use strict";(self.webpackChunkcontainer=self.webpackChunkcontainer||[]).push([[427],{427:(e,t,n)=>{n.r(t);var i=n(912),o=n(557),a=n(841);function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var u=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.root=t,this.routes=n,this.init()}var t,n;return t=e,(n=[{key:"init",value:function(){this.render(this.routes.find((function(e){return e.path===(window.location.hash||"#")}))),this.onNavigation()}},{key:"onNavigation",value:function(){var e=this;window.onhashchange=function(t){e.render(e.routes.find((function(e){return e.path===t.newURL.split("/").pop()})))}}},{key:"navigate",value:function(e){window.location.hash=e}},{key:"render",value:function(e){var t;e?(!e.canActivate||e.canActivate&&e.canActivate())&&(this.root.innerHTML=e.template,e.render()):window.location.hash=(null===(t=this.routes.find((function(e){return e.default})))||void 0===t?void 0:t.path)||"#"}}])&&r(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function c(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var s=function(){function e(){var t,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),n="ecomm:auth-data",(t="authKey")in this?Object.defineProperty(this,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):this[t]=n}var t,n;return t=e,(n=[{key:"getUsername",value:function(){var e;return null===(e=JSON.parse(this.getAuthData()||"{}"))||void 0===e?void 0:e.username}},{key:"getAuthData",value:function(){return window.localStorage.getItem(this.authKey)}},{key:"isAuthenticated",value:function(){return!!this.getAuthData()}},{key:"authenticate",value:function(e){window.localStorage.setItem(this.authKey,JSON.stringify(e))}},{key:"logout",value:function(){window.localStorage.removeItem(this.authKey)}}])&&c(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function l(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}new(function(){function e(t){var n,i,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),n=this,i="routes",o=[{path:"#login",template:'<div class="login"></div>',render:this.onLoginPageRender.bind(this)},{path:"#",template:'\n        <header>\n          <div class="header-wrapper">\n            <h1>Ecomm store</h1>\n            <div class="header-right-panel">\n              <div class="user">\n                <span>Hello, <span class="js-username"></span></span>\n                <button class="js-logout">Log out</button>\n              </div>\n              <div class="cart"></div>\n            </div>\n          </div>\n        </header>\n        <main>\n          <div class="products"></div>\n        </main>\n        <footer>\n          <p>Ecomm <b>MicroFrontends</b> with Module Federation plugin</p>\n          <p>&copy; Lorem ipsum dolor sit amet, 2022</p>\n        </footer>\n      ',render:this.onHomePageRender.bind(this),default:!0,canActivate:this.onCanActivateRoute.bind(this)}],i in n?Object.defineProperty(n,i,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[i]=o,this.container=t,this.init()}var t,n;return t=e,(n=[{key:"init",value:function(){this.authService=new s,this.router=new u(this.container,this.routes),this.initListeners()}},{key:"initListeners",value:function(){document.addEventListener("login:success",this.onLogin.bind(this))}},{key:"onLoginPageRender",value:function(){new a.Login(document.querySelector(".login"))}},{key:"onHomePageRender",value:function(){new i.Cart(document.querySelector(".cart")),new o.Products(document.querySelector(".products")),this.container.querySelector(".js-username").textContent=this.authService.getUsername(),this.container.querySelector(".js-logout").addEventListener("click",this.onLogout.bind(this))}},{key:"onCanActivateRoute",value:function(){var e=this.authService.isAuthenticated();return e||(window.location.hash="#login"),e}},{key:"onLogin",value:function(e){this.authService.authenticate(e.detail),this.router.navigate("#")}},{key:"onLogout",value:function(){this.authService.logout(),this.router.navigate("#login")}}])&&l(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}())(document.querySelector("#root"))}}]);